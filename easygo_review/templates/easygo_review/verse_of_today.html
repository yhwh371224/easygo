{% extends "easygo_review/base_verse.html" %}

{% block content %}
<style>
    html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
        font-family: 'Arial', sans-serif;
    }

    /* 화면 전체를 배경 이미지로 사용 */
    body {
        background-image: url("{{ image_path }}");
        background-size: cover;       /* 화면 꽉차게 */
        background-position: center;  /* 중앙 기준 */
        background-repeat: no-repeat;
        display: flex;
        justify-content: center;      /* 가로 중앙 */
        align-items: center;          /* 세로 중앙 */
        text-align: center;
        color: white;
        padding: 20px;
        box-sizing: border-box;
        height: 100vh;
    }

    /* 실제 성경 구절 텍스트 */
    .verse-text {
        margin: 0;
        font-size: clamp(18px, 6vw, 36px);
        line-height: 1.4em;
        word-wrap: break-word;
        text-shadow: 2px 2px 6px rgba(0,0,0,0.7); /* 글자 가독성 */
        color: white;
    }

    @media (max-width: 480px) {
        .verse-box {
            width: 90%;
            padding: 10px;
            min-height: 200px; /* ✅ 글씨 안 잘리게 */
        }
    }
</style>

{% if image_path %}
<div class="verse-box">
    <p class="verse-text" id="verse-text">{{ verse_text|linebreaksbr }}</p>
</div>
{% else %}
    <p>No image available.</p>
{% endif %}

<script>
    function fitTextToBox(textEl, boxEl) {
        let fontSize = parseInt(window.getComputedStyle(textEl).fontSize);
        const boxHeight = boxEl.clientHeight;
        const boxWidth = boxEl.clientWidth;

        // 글자가 박스를 벗어나면 폰트 줄이기
        while ((textEl.scrollHeight > boxHeight || textEl.scrollWidth > boxWidth) && fontSize > 5) {
            fontSize -= 1;
            textEl.style.fontSize = fontSize + "px";
        }
    }

    document.addEventListener("DOMContentLoaded", function() {
        const textEl = document.getElementById("verse-text");
        const boxEl = textEl.parentElement;

        fitTextToBox(textEl, boxEl);

        // 창 크기 변경 시에도 다시 맞춤
        window.addEventListener('resize', () => fitTextToBox(textEl, boxEl));
    });
</script>
{% endblock %}
